<html>
  <head>
    <title>Create Appointment</title>
    <%= stylesheet_link_tag 'appointments', media: 'all' %>
    <%= javascript_include_tag 'appointments' %>
  </head>
  <body>
    <div class="service-container">
      <h1>Please fill in the informationt to create appointment <%= @service.name%> by <%= @user.fname%></h1>

      <%= form_for @appointment, url: appointments_page_create_submit_path, method: :post do |form| %>
        <%= form.label "First Name" %>
        <%= form.text_field :fname, id: "First Name" %>

        <%= form.label "Last Name" %>
        <%= form.text_field :lname, id: "Last Name" %>

        <%= form.label "Email" %>
        <%= form.text_field :email, id: "Email" %>

         <%= form.label "Appointment Date" %>
        <%= form.select :startdatetime, options_for_select(@slots_data_start_datetime),{}, id: "Appointment Date" %>
        <%# <%= form.label "Appointment Date" %>
        
        <%= form.submit "Create Appointment", class: 'button' %>
       
      <% end %>



         <% if flash.now[:error].present? %> 
            <div class="flash-error">
                <%= flash[:error] %>
            </div>
        <% end %>
        <% if flash[:success].present? %>
                <div class="success-update">
                    <%= flash[:success] %>
                </div>
        <% end %>

        <%= link_to "Return to Public Page", public_page_path('John'), class: 'button'%>
    </div>
  </body>
  <script>
    async function fetch_slot_times() {
    // let start_date_dropdown = document.getElementById("Appointment Date");
    // // Get the selected value
    // var start_date = start_date_dropdown.value;

    // // Use the selected value as needed
    // let api_url = "/appointment/get/timings/" + start_date
    // const response = await fetch(api_url);
    // const data = await response.json().then((responseData) => {
    //     return responseData;
    // }).catch((error) => {
    //     console.log("error", error);
    //     return { "slots": [] }
    // });
    // console.log(data.slots)
    // console.log(data.slots.length)
    // if (data.slots.length > 0) {
    //     var dropdown_label = document.getElementById("start-time-label");
    //     var dropdown = document.getElementById("Consultation Start Time");
    //     console.log({ dropdown_label, dropdown });
    //     data.slots.forEach((slots_item) => {
    //         var dropdown_option = document.createElement("option");


    //         // Set the value and text of the option
    //         dropdown_option.value = new Date(slots_item.startTime).toTimeString();
    //         dropdown_option.text = new Date(slots_item.startTime).toTimeString();

    //         // Append the new option to the select element
    //         dropdown.appendChild(dropdown_option);
    //     });
    //     dropdown.classList = "";
    //     dropdown_label.classList = "";
    // }

}
  </script>
</html>